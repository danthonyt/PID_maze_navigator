@startuml

[*] --> STATE_IDLE
STATE_IDLE --> STATE_IDLE : else
STATE_IDLE --> STATE_START : start_wr == 1 or start_en == 1
STATE_START --> STATE_ADDR_1
STATE_ADDR_1 --> STATE_ADDR_2 

STATE_ADDR_2 --> STATE_WRITE_1 : mode == WRITE
STATE_WRITE_1 --> STATE_WRITE_2
STATE_WRITE_2--> STATE_WRITE_3
STATE_WRITE_3 --> STATE_STOP

STATE_ADDR_2 --> STATE_READ_1 : mode == READ
STATE_READ_1 --> STATE_READ_2
STATE_READ_2--> STATE_READ_3
STATE_READ_3 --> STATE_STOP

STATE_STOP --> STATE_IDLE
STATE_STOP --> STATE_STOP

@enduml